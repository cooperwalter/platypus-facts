service: platypus-facts

image: ghcr.io/cooperwalter/platypus-facts

servers:
  web:
    hosts:
      # Replace with your VPS IP address
      - <your-server-ip>
    options:
      network: kamal

registry:
  server: ghcr.io
  username:
    - KAMAL_REGISTRY_USERNAME
  password:
    - KAMAL_REGISTRY_PASSWORD

env:
  clear:
    PORT: 3000
    DATABASE_PATH: /app/data/platypus-facts.db
    DAILY_SEND_TIME_UTC: "14:00"
    MAX_SUBSCRIBERS: 1000
    NODE_ENV: production
  secret:
    - BASE_URL
    - OPENAI_API_KEY
    - BREVO_API_KEY
    - EMAIL_FROM

volumes:
  - /opt/platypus-facts/data:/app/data
  - /opt/platypus-facts/images:/app/public/images/facts

proxy:
  ssl: false
  host: platypus-facts.cooperwalter.dev
  app_port: 3000

healthcheck:
  path: /health
  port: 3000
  interval: 10
